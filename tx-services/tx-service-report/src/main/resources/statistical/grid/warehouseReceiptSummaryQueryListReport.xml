<?xml version="1.0" encoding="UTF-8" ?>
<report xmlns="http://wtms.com/xml/statistical-1.0.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://wtms.com/xml/statistical-1.0.xsd" code="warehouseReceiptSummaryQueryListReport"
        type="pagedListGrid" name="仓单汇总报表">
    <!-- 设计考虑根据report可以生成对应的页面：考虑技术：freemarker -->
    <!-- sql解析：利用Mybatis进行支撑：该支撑后期我来支撑，需要升级Mybatis -> 3.4 版本，现在tx-parent有兼容问题 -->
    <!-- report.type 要求能够通过实现接口进行扩展 -->
    <!-- report.conditions.item.type 要求能够通过实现接口进行扩展 -->
    <!-- report.views.item.type 要求能够通过实现接口进行扩展 -->

    <!-- code:必填：值不能重复 -->
    <!-- type:非必填：默认值为pagedListGrid 其他支持类型：listGrid|pagedListGrid 要求该类型支撑线性扩展1111 -->
    <!-- name:非必填：如果为空取code值 -->

    <!-- 页面附加的javascript:非必填 -->
    <script></script>

    <!-- cols：非必填： 默认为2 如果条件项小于3，则自动修改对应值，如果为3的倍数，则为3，如果为2的倍数则为2 -->
    <conditions>
        <!-- type:非必填： 默认为input 可选值:input|input_datetime|input_date :预制类型要求能够扩展，如果没有预制的允许通过js等进行支撑 -->
        <!-- class:非必填：默认为text -->
        <!-- default:非必填：默认填写值 -->
        <!-- readOnly:非必填：默认为false -->
        <item id="minCreateDate" name="开始时间" type="input" value="" readOnly="true"
              onClick="WdatePicker({readOnly:true,dateFmt:'yyyy-MM-dd' ,maxDate:'%y-%M-%d'})"/>
        <item id="maxCreateDate" name="结束时间" type="input" value="" readOnly="true"
              onClick="WdatePicker({readOnly:true,dateFmt:'yyyy-MM-dd' ,maxDate:'%y-%M-%d'})"/>
    </conditions>


    <!-- fitColumns:非必填，默认值为false -->
    <views fitColumns="false" sqlMapperId="queryWarehouseReceiptSummaryList">
        <!-- formatter: -->
        <!-- width:非必填：默认值为 150 -->
        <!-- hidden:非必填：false -->
        <!-- frozen:非必填：false -->
        <item column="WAREHOUSETYPENAME" name="仓单类型 "/>
        <item column="PRODUCTNAME" name="品名" statisticalType="count"/>
        <item column="ORIGINALVOUCHERCODE" name="仓单原始凭证 "/>
        <item column="WAREHOUSENAME" name="仓库名称"/>
        <item column="STATUS" name="仓单状态"
              type="enum" enumClass="com.tx.wtms.warehouse.mode.WarehouseReceiptStatusEnum"
              refValue="name"/>
        <item column="NUMBER" name="数量"/>
        <item column="ALREADYSPLITNUMBER" name="已分拆数量"/>
        <item column="NOTSPLITNUMBER" name="未分拆数量 "/>
        <item column="MEASUREMENTINFONAME" name="度量单位"/>
        <item column="UNITPRICE" name="单价"/>
        <item column="TOTALAMOUNT" name="总金额" statisticalType="sum"/>
        <item column="CREATEDATE" name="创建时间" type="date"/>
    </views>
    <sqlMappers>
        <!-- datebaseId:非必填: 如果不填则databaseId为默认值 -->
        <sqlMapper id="queryWarehouseReceiptSummaryList">
            SELECT
            WWR.PRODUCTNAME,
            WWR.ORIGINALVOUCHERCODE,
            WW.`NAME` AS WAREHOUSENAME,
            WWR. STATUS,
            WWR.NUMBER,
            WWR.ALREADYSPLITNUMBER,
            WWR.NOTSPLITNUMBER,
            BM.`NAME` AS MEASUREMENTINFONAME,
            WWR.UNITPRICE,
            WWR.TOTALAMOUNT,
            WWR.CREATEDATE,
            WWT.`NAME` AS WAREHOUSETYPENAME
            FROM
            WR_WAREHOUSE_RECEIPT WWR
            INNER JOIN WR_WAREHOUSETYPE WWT ON WWT.ID = WWR.WAREHOUSETYPEID
            INNER JOIN WR_WAREHOUSE WW ON WW.ID = WWR.WAREHOUSEID
            INNER JOIN BD_MEASUREMENTINFO BM ON BM.ID = WWR.MEASUREMENTINFOID
            WHERE 1=1
            <if test="@com.tx.core.util.OgnlUtils@isNotEmpty(maxCreateDate)">
                <![CDATA[ AND WWR.CREATEDATE <  DATE_ADD(#{maxCreateDate},INTERVAL 1 DAY)  ]]>
            </if>
            <if test="@com.tx.core.util.OgnlUtils@isNotEmpty(minCreateDate)">
                <![CDATA[ AND WWR.CREATEDATE >= #{minCreateDate,jdbcType=TIMESTAMP} ]]>
            </if>
        </sqlMapper>
    </sqlMappers>
</report>


